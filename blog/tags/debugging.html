
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1'>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#f98521">

    <title>Debugging &ndash; Joyful Bikeshedding</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    <link href="/stylesheets/site-7224e35b.css" rel="stylesheet" />

        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">

    <noscript>
        <link href="https://fonts.googleapis.com/css?family=Roboto:400,700,400italic|Roboto+Mono:400|PT+Sans:400,700|PT+Serif:400" rel="stylesheet">
    </noscript>
    <link rel="preconnect" href="http://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link rel="preconnect" href="https://ajax.googleapis.com" crossorigin>
    <link rel="shortcut icon" href="/images/favicon-1b152eac.png" type="image/png" />

    
    
</head>
<body>

    <header class="site-navbar site-navbar-small">
    <div class="nav-hero-container" role="banner">
        <a href="/" aria-hidden="true" class="logo-link"><img src="/images/avatar-b64f1ad5.png" srcset="/images/avatar-b64f1ad5.png 1x, /images/avatar@2x-693176a2.png 2x" class="logo" alt="Hongli Lai" /></a>

        <div class="nav-text-container">
            <div class="title"><a href="/" class="title-link">Joyful <br>Bikeshedding</a></div>
            <div class="subtitle"><a href="/" class="title-link">CTO's take on coding<br>&amp; company building</a></div>
        </div>
    </div>

    <nav class="nav-list-container">
        <ul class="nav-list">
            <li class="nav-item">
    <a class="nav-link" href="/">Blog</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="/blog/tags/featured.html">Featured Posts</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="/work_and_open_source.html">My Work</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="/about.html">About</a>
</li>
<li class="nav-item nav-item-with-image">
    <a href="/feed.xml" class="nav-link" title="RSS"><img src="/images/rss-8aadb988.svg" height="14" alt="RSS" /></a>
</li>
<!--
<li class="site-nav-item site-nav-item-with-image">
    <a class="site-nav-link" href="https://github.com/FooBarWidget" target="_blank"><img src="/images/github-button.svg" width="30" height="30" alt="Github" title="Github" /></a>
</li>
<li class="site-nav-item site-nav-item-with-image">
    <a class="site-nav-link" href="https://twitter.com/honglilai" target="_blank"><img src="/images/twitter-button.svg" width="30" height="30" alt="Twitter" title="Twitter" /></a>
</li>
<li class="site-nav-item site-nav-item-with-image">
    <a class="site-nav-link" href="https://www.linkedin.com/in/honglilai" target="_blank"><img src="/images/linkedin-button.svg" width="30" height="30" alt="LinkedIn" title="LinkedIn" /></a>
</li>
<li class="site-nav-item site-nav-item-with-image">
    <a class="site-nav-link" href="https://keybase.io/foobarwidget" target="_blank"><img src="/images/keybase-button.svg" width="30" height="30" alt="Keybase" title="Keybase" /></a>
</li>
<li class="site-nav-item site-nav-item-with-image site-nav-item-with-image-squared">
    <a class="site-nav-link" href="mailto:hongli@hongli.nl"><img src="/images/email-button.svg" width="30" height="30" alt="Email" title="Email" /></a>
</li>
-->
        </ul>
    </nav>
</header>

    <header class="site-navbar site-navbar-large" style="display: none">
    <div class="nav-hero-container">
        <a href="/" role="banner" class="logo-link"><img src="/images/avatar-b64f1ad5.png" srcset="/images/avatar-b64f1ad5.png 1x, /images/avatar@2x-693176a2.png 2x" class="logo" alt="Hongli Lai" /></a>

        <div class="nav-text-container">
            <div class="title" role="banner"><a href="/" class="title-link">Joyful Bikeshedding</a></div>
            <div class="subtitle" role="banner"><a href="/" class="title-link">CTO's take on coding &amp; company building</a></div>
            <nav class="nav-list-container">
                <ul class="nav-list">
                    <li class="nav-item">
    <a class="nav-link" href="/">Blog</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="/blog/tags/featured.html">Featured Posts</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="/work_and_open_source.html">My Work</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="/about.html">About</a>
</li>
<li class="nav-item nav-item-with-image">
    <a href="/feed.xml" class="nav-link" title="RSS"><img src="/images/rss-8aadb988.svg" height="14" alt="RSS" /></a>
</li>
<!--
<li class="site-nav-item site-nav-item-with-image">
    <a class="site-nav-link" href="https://github.com/FooBarWidget" target="_blank"><img src="/images/github-button.svg" width="30" height="30" alt="Github" title="Github" /></a>
</li>
<li class="site-nav-item site-nav-item-with-image">
    <a class="site-nav-link" href="https://twitter.com/honglilai" target="_blank"><img src="/images/twitter-button.svg" width="30" height="30" alt="Twitter" title="Twitter" /></a>
</li>
<li class="site-nav-item site-nav-item-with-image">
    <a class="site-nav-link" href="https://www.linkedin.com/in/honglilai" target="_blank"><img src="/images/linkedin-button.svg" width="30" height="30" alt="LinkedIn" title="LinkedIn" /></a>
</li>
<li class="site-nav-item site-nav-item-with-image">
    <a class="site-nav-link" href="https://keybase.io/foobarwidget" target="_blank"><img src="/images/keybase-button.svg" width="30" height="30" alt="Keybase" title="Keybase" /></a>
</li>
<li class="site-nav-item site-nav-item-with-image site-nav-item-with-image-squared">
    <a class="site-nav-link" href="mailto:hongli@hongli.nl"><img src="/images/email-button.svg" width="30" height="30" alt="Email" title="Email" /></a>
</li>
-->
                </ul>
            </nav>
        </div>
    </div>
</header>


      <main class="main-container main-container-with-post-previews">
    <header class="page-display-header">
      <h1>Debugging</h1>
      <hr>
    </header>

    <section class="post-previews">
          <article class="post part-of-preview">
        <header class="post-header part-of-preview">
            <a href="/blog/2025-02-10-causes-of-major-page-faults.html" aria-hidden="true" class="post-banner preview">
      <picture>
        <source srcset="&#x2F;images&#x2F;2025&#x2F;major-page-faults.avif" type="image&#x2F;avif">
<source srcset="&#x2F;images&#x2F;2025&#x2F;major-page-faults-929b64f7.jpg" type="image&#x2F;jpeg">
        <img
          src="&#x2F;images&#x2F;2025&#x2F;major-page-faults-929b64f7.jpg"
          style=""
          title=""
          class="bg">
      </picture>
    </a>
            <h2 class="title"><a href="/blog/2025-02-10-causes-of-major-page-faults.html">Causes of major page faults</a></h2>
            <div class="meta-container">
                <div class="meta-main-area">
                    <ul class="meta-list">
                        <li class="meta-item">
                            <a href="/about.html" class="author-display-name-link">By Hongli Lai</a>
                        </li>
                        <li class="meta-item">
                            <time datetime="2025-02-10">Feb 10, 2025</time>
                        </li>
                        <li class="meta-item">
                            <a href="/blog/tags/unix.html">Unix</a>, <a href="/blog/tags/debugging.html">Debugging</a>, <a href="/blog/tags/featured.html">Featured posts</a>
                        </li>
                    </ul>
                </div>
            </div>
        </header>
        <div class="post-content post-content-preview part-of-preview">
            <p>There's a common Prometheus alert called "NodeMemoryMajorPagesFaults". It's <a href="https://github.com/prometheus/node_exporter/blob/v1.8.2/docs/node-mixin/alerts/alerts.libsonnet#L347">part of the Node Exporter's node-mixin project</a> and also <a href="https://github.com/prometheus-community/helm-charts/blob/prometheus-node-exporter-4.43.1/charts/kube-prometheus-stack/templates/prometheus/rules-1.14/node-exporter.yaml#L652">included in the kube-prometheus-stack default alert rules</a>.</p>

<picture><img src="/images/2025/node-memory-major-page-faults-alert-49d1e9fd.png" alt="NodeMemoryMajorPageFaults alert" style="box-shadow: 0px 0px 4px #bbb"></picture>

<p>But what does this alert mean, and what do you do about it? This article helps you form a good mental model and provides practical guidance.</p>

<p><strong></strong></p>
            <div class="post-read-more"><a href="/blog/2025-02-10-causes-of-major-page-faults.html" class="outline-button orange">Read more &raquo;</a></div>
        </div>
    </article>
    <article class="post part-of-preview">
        <header class="post-header part-of-preview">
            <a href="/blog/2020-07-21-why-piping-to-cat-can-stuck-a-ci-job.html" aria-hidden="true" class="post-banner preview">
      <picture>
        <source srcset="&#x2F;images&#x2F;2020&#x2F;stuck-cat-4a05c666.jpg" type="image&#x2F;jpeg">
        <img
          src="&#x2F;images&#x2F;2020&#x2F;stuck-cat-4a05c666.jpg"
          style=""
          title=""
          class="bg">
      </picture>
    </a>
            <h2 class="title"><a href="/blog/2020-07-21-why-piping-to-cat-can-stuck-a-ci-job.html">Why piping to &#x27;cat&#x27; can stuck a CI job ðŸ™€</a></h2>
            <div class="meta-container">
                <div class="meta-main-area">
                    <ul class="meta-list">
                        <li class="meta-item">
                            <a href="/about.html" class="author-display-name-link">By Hongli Lai</a>
                        </li>
                        <li class="meta-item">
                            <time datetime="2020-07-21">Jul 21, 2020</time>
                        </li>
                        <li class="meta-item">
                            <a href="/blog/tags/devops.html">DevOps</a>, <a href="/blog/tags/shell-scripting.html">Shell scripting</a>, <a href="/blog/tags/debugging.html">Debugging</a>, <a href="/blog/tags/unix.html">Unix</a>
                        </li>
                    </ul>
                </div>
            </div>
        </header>
        <div class="post-content post-content-preview part-of-preview">
            <p>What's the difference between <code>command</code> and <code>command | cat</code>? There shouldn't be any, right? The first prints the output directly, and the latter prints output via cat, but they should have the same effect. Not so: the latter can cause the command to get stuck indefinitely. This has given a particular CI pipeline of mine quite some headache.</p>

<p>To learn why this happens, and how we can mitigate this problem, we need to dive into the arcane magic that is Unix process management. Join me on this journey.</p>

<p><strong></strong></p>
            <div class="post-read-more"><a href="/blog/2020-07-21-why-piping-to-cat-can-stuck-a-ci-job.html" class="outline-button orange">Read more &raquo;</a></div>
        </div>
    </article>
    <article class="post part-of-preview">
        <header class="post-header part-of-preview">
            <a href="/blog/2019-08-27-debugging-docker-builds.html" aria-hidden="true" class="post-banner preview">
      <picture>
        <source srcset="&#x2F;images&#x2F;stock-bg&#x2F;dmitri-popov-367732-unsplash-ba228fc4.jpg" type="image&#x2F;jpeg">
        <img
          src="&#x2F;images&#x2F;stock-bg&#x2F;dmitri-popov-367732-unsplash-ba228fc4.jpg"
          style=""
          title="Photo by Dmitri Popov on Unsplash"
          class="bg">
      </picture>
    </a>
            <h2 class="title"><a href="/blog/2019-08-27-debugging-docker-builds.html">Debugging Docker builds</a></h2>
            <div class="meta-container">
                <div class="meta-main-area">
                    <ul class="meta-list">
                        <li class="meta-item">
                            <a href="/about.html" class="author-display-name-link">By Hongli Lai</a>
                        </li>
                        <li class="meta-item">
                            <time datetime="2019-08-27">Aug 27, 2019</time>
                        </li>
                        <li class="meta-item">
                            <a href="/blog/tags/docker.html">Docker</a>, <a href="/blog/tags/debugging.html">Debugging</a>, <a href="/blog/tags/featured.html">Featured posts</a>
                        </li>
                    </ul>
                </div>
            </div>
        </header>
        <div class="post-content post-content-preview part-of-preview">
            <p>One of the projects I'm working on has a CI/CD pipeline that builds Docker images. The Dockerfile runs <code>yarn install</code>, then <code>yarn build</code>. The latter runs the TypeScript compiler <code>tsc</code>. Everything was working fine, but one day the build failed with the following error:</p>

<div class="highlight"><pre class="highlight plaintext"><code>tsc: command not found
</code></pre></div>
<p>But TypeScript is still part of package.json. Nobody touched package.json or yarn.lock recently. Nobody could reproduce the problem locally with Docker: it only happened in the CI/CD pipeline. What is going on? We needed to <strong>debug</strong> the Docker build on the CI/CD server.</p>

<p><strong></strong></p>
            <div class="post-read-more"><a href="/blog/2019-08-27-debugging-docker-builds.html" class="outline-button orange">Read more &raquo;</a></div>
        </div>
    </article>
    <article class="post part-of-preview">
        <header class="post-header part-of-preview">
            <a href="/blog/2019-01-31-full-system-dynamic-tracing-on-linux-using-ebpf-and-bpftrace.html" aria-hidden="true" class="post-banner preview">
      <picture>
        <source srcset="&#x2F;images&#x2F;2019&#x2F;usdt-tracepoints-90e8a430.png" type="image&#x2F;png">
        <img
          src="&#x2F;images&#x2F;2019&#x2F;usdt-tracepoints-90e8a430.png"
          style=""
          title=""
          class="bg">
      </picture>
    </a>
            <h2 class="title"><a href="/blog/2019-01-31-full-system-dynamic-tracing-on-linux-using-ebpf-and-bpftrace.html">Full-system dynamic tracing on Linux using eBPF and bpftrace</a></h2>
            <div class="meta-container">
                <div class="meta-main-area">
                    <ul class="meta-list">
                        <li class="meta-item">
                            <a href="/about.html" class="author-display-name-link">By Hongli Lai</a>
                        </li>
                        <li class="meta-item">
                            <time datetime="2019-01-31">Jan 31, 2019</time>
                        </li>
                        <li class="meta-item">
                            <a href="/blog/tags/linux.html">Linux</a>, <a href="/blog/tags/tracing.html">Tracing</a>, <a href="/blog/tags/operating-systems.html">Operating systems</a>, <a href="/blog/tags/debugging.html">Debugging</a>, <a href="/blog/tags/featured.html">Featured posts</a>
                        </li>
                    </ul>
                </div>
            </div>
        </header>
        <div class="post-content post-content-preview part-of-preview">
            <p>Linux has two well-known tracing tools:</p>

<ul>
  <li>
<a href="https://en.wikipedia.org/wiki/Strace">strace</a> allows you to see what system calls are being made.</li>
  <li>
<a href="https://en.wikipedia.org/wiki/Ltrace">ltrace</a> allows you to see what dynamic library calls are being made.</li>
</ul>

<p>Though useful, these tools are limited. What if you want to trace what happens inside a system call or library call? What if you want to do more than just logging calls, e.g. you want to compile statistics on certain behavior? What if you want to trace multiple processes and correlate data from multiple sources?</p>

<p>In 2019, there's finally a decent answer to that on Linux: <a href="https://github.com/iovisor/bpftrace">bpftrace</a>, based on <a href="https://lwn.net/Articles/740157/">eBPF</a> technology. Bpftrace allows you to write small programs that execute whenever an event occurs.</p>

<p>This article shows you how to setup bpftrace and teaches you its basic usage. I'll also give an overview of how the tracing ecosystem looks like (e.g. "what's eBPF?") and how it came to be what it is today.</p>

<p><strong></strong></p>
            <div class="post-read-more"><a href="/blog/2019-01-31-full-system-dynamic-tracing-on-linux-using-ebpf-and-bpftrace.html" class="outline-button orange">Read more &raquo;</a></div>
        </div>
    </article>

    </section>

      

    <aside class="about-me-panel-container after-post-previews">
      <div class="about-me-panel after-post-previews">
    <div class="message-area">
        <h2 class="heading">Hi, I'm Hongli Lai</h2>
        <p>
            I'm a software developer, consultant, CTO and entrepreneur. I mentor people to help them grow. For 20 years Iâ€™ve been building tools that make people happy. I believe that software development and work should be fun.
        </p>
        <p><a href="/about.html" class="outline-button orange">About Hongli</a></p>
    </div>
    <div class="image-area">
        <a href="/about.html"><img src="/images/profile-3c15ec0c.jpg" width="128" height="128" class="profile-image" alt="Hongli Lai" /></a>
    </div>
</div>

    </aside>
  </main>


    <footer class="site-footer">
        <div class="container">
            <h2 class="heading">
                    <span class="preamble">You are reading</span>
                <span class="title">Joyful Bikeshedding</span>
            </h2>
            <div class="subscribe-action"><a href="/feed.xml" class="outline-button white prominent">subscribe by RSS</a></div>
            <div class="social-media-follow-action"><a href="/about.html#contact">or check me out on social media</a></div>

            <div class="legal-boilerplate">
                <p>Twitter icon made by <a href="https://www.flaticon.com/authors/elegant-themes">Elegant Themes</a>, Github icon made by <a href="https://www.flaticon.com/authors/dave-gandy">Dave Gandy</a>. These are licensed by <a href="http://creativecommons.org/licenses/by/3.0/">CC 3.0 BY</a>.</p>
            </div>
        </div>
    </footer>

    <!--
      Unfortunately Google Fonts does not allow setting font-display.
      Force loading of fonts using the 'font swap period' strategy.
     -->
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <script>
        WebFont.load({ google: { families: [
            'Roboto:400,700,400italic',
            'Roboto Mono:400',
            'PT Sans:400,700',
            'PT Serif:400'
        ] } });
    </script>

        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116211414-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-116211414-1', { anonymize_ip: true });
        </script>

        <script async src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
        <script>
        window.addEventListener("load", function(){
        window.cookieconsent.initialise({
          "palette": {
            "popup": {
              "background": "#efefef",
              "text": "#404040"
            },
            "button": {
              "background": "#F7A51A",
              "text": "#ffffff"
            }
          },
          "position": "bottom-right",
          "content": {
            "message": "This website uses cookies for anonymous visitor analytics."
          }
        })});
        </script>
</body>
</html>
